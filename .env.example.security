# Пример конфигурации для безопасности
# Скопируйте этот файл в .env и заполните необходимые значения

# ========== БЕЗОПАСНОСТЬ ==========

# Secret key для JWT токенов
SECRET_KEY=your-super-secret-key-change-this-in-production
JWT_SECRET_KEY=your-jwt-secret-key-change-this-in-production

# ========== REDIS ==========

# Redis для rate limiting и кеширования
# Если Redis недоступен, система будет использовать БД как fallback
REDIS_URL=redis://localhost:6379/0
REDIS_TIMEOUT=5

# ========== RATE LIMITING ==========

# Лимиты запросов в минуту
RATE_LIMIT_GLOBAL=60
RATE_LIMIT_AUTH=5
RATE_LIMIT_POST=10
RATE_LIMIT_COMMENT=20
RATE_LIMIT_API=50

# ========== BOT DETECTION ==========

# Требовать CAPTCHA если bot score > этого значения
BOT_DETECTION_THRESHOLD=50

# ========== SPAM DETECTION ==========

# Пороге для флага спама для модерации
SPAM_FLAG_THRESHOLD=7
SPAM_MAX_URLS_PER_POST=2
SPAM_MAX_URLS_PER_COMMENT=1

# Минут для проверки дублирующегося контента
DUPLICATE_CHECK_MINUTES=5

# ========== ACCOUNT SECURITY ==========

# Максимум сессий на одного пользователя
MAX_SESSIONS_PER_USER=5

# Timeout сессии в часах
SESSION_TIMEOUT=24

# Timeout для двухфакторной аутентификации в минутах
TWO_FA_TIMEOUT=5

# Максимум доверенных устройств
MAX_IP_ADDRESSES=10

# Требовать IP whitelist для входа
ENFORCE_IP_WHITELIST=false

# ========== SECURITY SETTINGS ==========

# Максимум неудачных попыток входа перед блокировкой
MAX_FAILED_LOGINS=5

# Длительность блокировки при неудачном входе (минут)
LOCKOUT_DURATION=30

# ========== EMAIL (для 2FA) ==========

MAIL_SERVER=smtp.gmail.com
MAIL_PORT=587
MAIL_USE_TLS=true
MAIL_USERNAME=your-email@gmail.com
MAIL_PASSWORD=your-app-password

# ========== DATABASE ==========

# PostgreSQL (используйте эту строку или отдельные переменные ниже)
# Примеры правильного формата:
# DATABASE_URL=postgresql://user:password@localhost:5432/freedom13
# DATABASE_URL=postgresql://postgres:yourpassword@db.example.com:5432/dbname
DATABASE_URL=

# ИЛИ используйте отдельные переменные (если DATABASE_URL пусто)
DB_USER=postgres
DB_PASSWORD=
DB_HOST=localhost
DB_PORT=5432
DB_NAME=freedom13

# ВАЖНО: Если используете пароль с спецсимволами, замените их на URL-encoded версию:
# @ -> %40
# : -> %3A
# / -> %2F
# Пример: пароль "p@ss:word" становится "p%40ss%3Aword"

# ========== LOGGING ==========

LOG_LEVEL=INFO
SECURITY_LOG_FILE=logs/security.log
